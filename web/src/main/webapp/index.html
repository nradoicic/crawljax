<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <title>CrawljaxUI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/wrap.css" rel="stylesheet">
	<link href="css/bootstrap-responsive.min.css" rel="stylesheet">
	
	 <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <script type="text/x-handlebars">
	<div class="navbar navbar-inverse navbar-fixed-top">
      	<div class="navbar-inner">{{partial header}}</div>
    </div>
	<div class="container">
		<div class="row">{{outlet}}</div>
	</div>  		
	</script>
	
	<script type="text/x-handlebars" data-template-name="_header">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://www.crawljax.com" target="_blank">Crawljax</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="active"><a href="#">Home</a></li>
              <li><a href="http://www.crawljax.com/about" target="_blank">About</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
	</script>
	
	<script type="text/x-handlebars" data-template-name="_sidebar">
	<div class="span3">
		{{view App.BreadcrumbView}}
        <div class="well sidebar-nav">{{view App.SideNavView}}</div>
        <div class="well sidebar-nav">
            <ul class="nav nav-list">
          	  	<li class="nav-header">Crawl Execution Queue</li>
				{{#each controller.controllers.application.executionQueue}}
				<li><span>{{#linkTo 'history' this}}#{{id}}{{/linkTo}} {{configurationName}} - <i>{{crawlStatus}}</i></span></li>
				{{else}}
				<li><i>empty</i></li>
				{{/each}}
          	</ul>
        </div> 
    </div> 
	</script>

	<script type="text/x-handlebars" data-template-name="config_list">
	{{partial sidebar}}     
    <div class="span9">
		<table class="table table-striped">
			<thead>
 				<tr><th>Name</th><th>Site</th><th>Last Crawl</th><th>Last Duration</th></tr>
 			</thead>
 			<tbody>
				{{#unless controller.content.isLoading }}
				{{#each controller}}
 				<tr>
 					<td>{{#linkTo 'config' this.content}}{{name}}{{/linkTo}}</td>
 					<td><a {{bindAttr href="url"}} target="_blank">{{url}}</a></td>
 					<td>{{formatLastCrawl}}</td>
 					<td>{{formatLastDuration}}</td>
 				</tr>
				{{else}}<tr><td colspan="5">No available configurations.</td></tr>{{/each}}
				{{else}}<tr><td colspan="5">Loading configurations.</td></tr>{{/unless}}
 			</tbody>
		</table>
	</div><!--/span-->	
	</script>
	
	<script type="text/x-handlebars" data-template-name="new">{{partial sidebar}}<div class="span9">{{partial config_general}}</div></script>
	
	<script type="text/x-handlebars" data-template-name="config">{{partial sidebar}}<div class="span9">{{outlet}}</div></script>
	
	<script type="text/x-handlebars" data-template-name="_config_tabs">
	<ul class="nav nav-tabs">
		{{#view App.NavView route='config.index' }}<a href='#' {{action moveTo view.route }}>Overview</a>{{/view}}
		{{#view App.NavView route='config.rules' }}<a href='#' {{action moveTo view.route }}>Crawl Rules</a>{{/view}}
		{{#view App.NavView route='config.assertions' }}<a href='#' {{action moveTo view.route }}>Assertions</a>{{/view}}
	</ul>
	</script>
	
	<script type="text/x-handlebars" data-template-name="config/index">{{partial config_tabs}}{{partial config_general}}</script>
	
	<script type="text/x-handlebars" data-template-name="_config_general">
	<form id="config_form" class="form-horizontal">	
	<fieldset>
		<legend>General Information</legend>
		{{#if controller.content.id}}
			{{view App.FormField label="Name: " valueBinding="controller.content.name"}}
		{{else}}
			{{view App.FormTextField label="Name: " valueBinding="controller.content.name" placeholder="Configuration Name" required="true" errorText="This field is Required"}}
		{{/if}}
		{{view App.FormTextField label="Site: " valueBinding="controller.content.url" placeholder="http://www.example.com" type="url" 
			required="true" pattern="(http|https)://.+" errorText="Must provide a valid url. http://www.example.com"}}
		{{view App.FormSelect label="Browser: " valueBinding="controller.content.browser" contentBinding="App.browsers" optionValuePath="content.value"
       		optionLabelPath="content.name"}}
		{{view App.FormTextField type="number" min="1" label="Number of Browsers: " valueBinding="controller.content.numBrowsers"}}
		{{view App.FormCheckbox label="Boot Browsers at Start" checkedBinding="controller.content.bootBrowser"}}
		{{view App.FormTextField type="number" min="0" label="Maximum Crawl Depth: " valueBinding="controller.content.maxDepth"}}
		{{view App.FormTextField type="number" min="0" label="Maximum Crawl States: " valueBinding="controller.content.maxState"}}
		{{view App.FormTextField type="number" min="0" label="Maximum Duration(min): " valueBinding="controller.content.maxDuration"}}
		{{view App.FormTextField type="number" min="0" label="Event Wait Time(ms): " valueBinding="controller.content.eventWaitTime"}}
		{{view App.FormTextField type="number" min="0" label="Reload Wait Time(ms): " valueBinding="controller.content.reloadWaitTime"}}
		{{view App.FormCheckbox label="Click Elements Once" checkedBinding="controller.content.clickOnce"}}
	</fieldset>
	</form>
	</script>
	
	<script type="text/x-handlebars" data-template-name="config/rules">
	{{partial config_tabs}}
	<form id="config_form" class="form-horizontal">	
		<fieldset>
			<legend>Click Rules</legend>
			<label class="checkbox">
				{{view Ember.Checkbox checkedBinding="controller.content.clickDefault" }}
				 Click Default Elements</label>
			{{#unless controller.content.clickDefault}}<br />
				{{render 'click_rules' controller.content.clickRules }}
			{{/unless}}
		</fieldset><br />
		<fieldset>
			<legend>Page Conditions</legend>
			{{render 'conditions' controller.content.pageConditions }}
		</fieldset><br />
		<fieldset>
			<legend>State Filters</legend>
			{{render 'comparators' controller.content.comparators }}
		</fieldset><br />
		<fieldset>
			<legend>Form Field Input Values</legend>
			<label class="checkbox">
				{{view Ember.Checkbox checkedBinding="controller.content.randomFormInput"}}
				 Use Random Values in Form Fields</label>
			{{render 'form_inputs' controller.content.formInputValues }}
		</fieldset>
	</form>
	</script>
	
	<script type="text/x-handlebars" data-template-name="click_rules">
		{{#if controller.content}}
		<table class="table table-condensed">
			{{#each controller}}
 			<tr>
 				<td width="30px">{{view App.FormSelect valueBinding='rule' contentBinding='App.clickType' optionValuePath="content.value"
       				optionLabelPath="content.name" inputClassNames='input-small' isForm=''}}</td>
 				<td width="30px">{{view App.FormSelect valueBinding='elementTag' contentBinding='App.tags' inputClassNames='input-small' isForm=''}}</td>
				<td>
					{{#if conditions}}
					<table class="table table-striped table-condensed" style="margin-bottom: 0px;">
						{{#each con in conditions}}
 						<tr>
 							<td>{{view App.FormSelect valueBinding='con.condition' contentBinding="App.clickConditions" optionValuePath="content.value"
       							optionLabelPath="content.name" isForm=''}}</td>
 							<td>{{view App.FormTextField valueBinding='con.expression' isForm='' required='true' 
								inputClassNames='input-xlarge' errorText='This field is Required'}}</td>
							<td><a href="#" {{action 'removeCondition' con}}><i class="icon-remove"></i></a></td>
 						</tr>
						{{/each}}
					</table>
					{{/if}}
					<a href="#" {{action 'addCondition'}}><i class="icon-plus"></i>Condition</a>				
				</td>
 				<td><a href="#" {{action 'remove' this.content}}>Remove</a></td>
 			</tr>
			{{/each}}
		</table>
		{{/if}}
		<a href="#" {{action 'add'}}> Add a New Click Rule</a>
	</script>
	
	<script type="text/x-handlebars" data-template-name="conditions">
		{{#if controller.content}}
		<table class="table table-striped table-condensed">
			{{#each controller}}
 			<tr>
 				<td>{{view App.FormSelect valueBinding='condition' contentBinding="App.pageConditions" optionValuePath="content.value"
       				optionLabelPath="content.name" isForm=''}}</td>
 				<td>{{view App.FormTextField valueBinding='expression' isForm='' required='true' 
					inputClassNames='input-xlarge' errorText='This field is Required'}}</td>
 				<td><a href="#" {{action 'remove' this}}>Remove</a></td>
 			</tr>
			{{/each}}
		</table>
		{{/if}}
		<a href="#" {{action 'add'}}> Add a New Condition</a>
	</script>
	
	<script type="text/x-handlebars" data-template-name="comparators">
		{{#if controller.content}}
		<table class="table table-striped table-condensed">
			{{#each comparator in controller}}
 			<tr>
 				<td>{{view App.FormSelect valueBinding='comparator.type' contentBinding="App.comparators" optionValuePath="content.value"
       				optionLabelPath="content.name" isForm=''}}</td>
 				<td>{{#if comparator.needsExpression}}{{view App.FormTextField valueBinding='comparator.expression' isForm='' required='true' 
					inputClassNames='input-xlarge' errorText='This field is Required'}}{{/if}}</td>
 				<td><a href="#" {{action 'remove' comparator.content}}>Remove</a></td>
 			</tr>
			{{/each}}
		</table>
		{{/if}}
		<a href="#" {{action 'add'}}> Add a New Filter</a>
	</script>
	
	<script type="text/x-handlebars" data-template-name="form_inputs">
	{{#if controller.content}}
	<table class="table table-striped table-condensed">
		<thead>
			<tr><th>Element Id/Name</th><th>Value</th><th></th></tr>
		</thead>
		<tbody>
			{{#each controller}}
			<tr>
				<td>{{view App.FormTextField valueBinding='name' required='true' isForm='' errorText='This field is Required'}}</td>
				<td>{{view App.FormTextField valueBinding='value' isForm='' inputClassNames='input-xlarge'}}</td>
				<td><a href="#" {{action 'remove' this}}>Remove</a></td>
			</tr>
			{{/each}}
		</tbody>
	</table>
	{{/if}}
	<a href="#" {{action 'add'}}> Add a New Field</a>
	</script>
	
	<script type="text/x-handlebars" data-template-name="config/assertions">
	{{partial config_tabs}}
	<form id="config_form" class="form-horizontal">	
		<fieldset>
			<legend>Invariants</legend>
			{{render 'conditions' controller.content.invariants }}
		</fieldset>
	</form>
	</script>
	
	<script type="text/x-handlebars" data-template-name="config/plugins">
	{{partial config_tabs}}
	<form id="config_form" class="form-horizontal">	
		<fieldset>
			<legend>Plugins</legend>
		</fieldset>
	</form>
	</script>
	
	<script type="text/x-handlebars" data-template-name="history_list">{{partial sidebar}}{{outlet}}</script>
	
	<script type="text/x-handlebars" data-template-name="history_list/index">
	<div class="span9">
		<table class="table table-striped">
			<thead>
 				<tr><th>Crawl ID</th><th>Configuration</th><th>Execution Time</th></tr>
 			</thead>
 			<tbody>
				{{#unless controller.content.isLoading }}
				{{#each controller}}
 				<tr>
 					<td>{{#linkTo 'history' this.content}}{{id}}{{/linkTo}}</td>
 					<td><a {{bindAttr href="configURL"}}>{{configurationName}}</a></td>
 					<td>{{formatStartTime}}</td>
 				</tr>
				{{else}}<tr><td colspan="3">No available crawls.</td></tr>{{/each}}
				{{else}}<tr><td colspan="3">Loading crawl history.</td></tr>{{/unless}}
 			</tbody>
		</table>
	</div><!--/span-->
	</script>	
	
	<script type="text/x-handlebars" data-template-name="history/index">
	<div class="span9">
		<ul class="nav nav-tabs">
		{{#view App.NavView route='history_list.history.index' }}{{#linkTo 'history.index' }}Log{{/linkTo}}{{/view}}
		{{#if controller.isFinished}}{{#view App.NavView route='history_list.history.overview' }}{{#linkTo 'history.overview' }}Overview{{/linkTo}}{{/view}}{{/if}}
		</ul>
		<div id="logPanel"></div>
	</div><!--/span-->
	</script>
	
	<script type="text/x-handlebars" data-template-name="history/overview">
	<div class="span9">
		<ul class="nav nav-tabs">
		{{#view App.NavView route='history_list.history.index' }}{{#linkTo 'history.index' }}Log{{/linkTo}}{{/view}}
		{{#view App.NavView route='history_list.history.overview' }}{{#linkTo 'history.overview' }}Overview{{/linkTo}}{{/view}}
		</ul>
		<iframe {{bindAttr src="overviewURL"}} id="overviewFrame" scrolling="no" seamless></iframe>
	</div><!--/span-->
	</script>

	<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/handlebars.js"></script>
	<script type="text/javascript" src="js/ember-1.0.0-rc.1.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript" src="js/models.js"></script>
    <script type="text/javascript" src="js/views.js"></script>
    <script type="text/javascript" src="js/controllers.js"></script>
    <script type="text/javascript" src="js/validation.js"></script>
</body>
</html>
